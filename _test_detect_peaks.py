import peaks
import numpy as np
import matplotlib.pyplot as plt
import savitzky_golay as sg

rt_list = [2902.56, 2905.97, 2909.39, 2912.8, 2916.22, 2919.63, 2923.04, 2926.46, 2929.87, 2933.29, 2936.7, 2940.11, 2943.53, 2946.94, 2950.35, 2953.77, 2957.18, 2960.6, 2964.01, 2967.42, 2970.84, 2974.25, 2977.67, 2981.08, 2984.49, 2987.91, 2991.32, 2994.74, 2998.15, 3001.56, 3004.98, 3008.39, 3011.81, 3015.22, 3018.63, 3022.05, 3025.46, 3028.87, 3032.29, 3035.7, 3039.12, 3042.53, 3045.94, 3049.36, 3052.77, 3056.19, 3059.6, 3063.01, 3066.43, 3069.84, 3073.26, 3076.67, 3080.08, 3083.5, 3086.91, 3090.32, 3093.74, 3097.15, 3100.57, 3103.98, 3107.39, 3110.81, 3114.22, 3117.64, 3121.05, 3124.46, 3127.88, 3131.29, 3134.71, 3138.12, 3141.53, 3144.95, 3148.36, 3151.78, 3155.19, 3158.6, 3162.02, 3165.43, 3168.84, 3172.26, 3175.67, 3179.09, 3182.5, 3185.91, 3189.33, 3192.74, 3196.16, 3199.57, 3202.98, 3206.4, 3209.81, 3213.23, 3216.64, 3220.05, 3223.47, 3226.88, 3230.3, 3233.71, 3237.12, 3240.54, 3243.95, 3247.36, 3250.78, 3254.19, 3257.61, 3261.02, 3264.43, 3267.85, 3271.26, 3274.68, 3278.09, 3281.5, 3284.92, 3288.33, 3291.75, 3295.16, 3298.57, 3301.99, 3305.4, 3308.82, 3312.23, 3315.64, 3319.06, 3322.47, 3325.88, 3329.3, 3332.71, 3336.13, 3339.54, 3342.95, 3346.37, 3349.78, 3353.2, 3356.61, 3360.02, 3363.44, 3366.85, 3370.27, 3373.68, 3377.09, 3380.51, 3383.92, 3387.33, 3390.75, 3394.16, 3397.58, 3400.99, 3404.4, 3407.82, 3411.23, 3414.65, 3418.06, 3421.47, 3424.89, 3428.3, 3431.72, 3435.13, 3438.54, 3441.96, 3445.37, 3448.79, 3452.2, 3455.61, 3459.03, 3462.44, 3465.85, 3469.27, 3472.68, 3476.1, 3479.51, 3482.92, 3486.34, 3489.75, 3493.17, 3496.58]
i_list = [523.0, 715.0, 1488.0, 2555.0, 3186.0, 2939.0, 2708.0, 2087.0, 1065.0, 723.0, 691.0, 530.0, 470.0, 613.0, 520.0, 450.0, 795.0, 1225.0, 1660.0, 2283.0, 3032.0, 4107.0, 5916.0, 6507.0, 6267.0, 5218.0, 3572.0, 1986.0, 1040.0, 946.0, 696.0, 684.0, 387.0, 437.0, 470.0, 469.0, 460.0, 407.0, 367.0, 428.0, 633.0, 480.0, 428.0, 743.0, 674.0, 794.0, 796.0, 1132.0, 1964.0, 3981.0, 10436.0, 17409.0, 21713.0, 22013.0, 20111.0, 20621.0, 20140.0, 21605.0, 21521.0, 18760.0, 11857.0, 5900.0, 2341.0, 663.0, 521.0, 500.0, 624.0, 703.0, 705.0, 1092.0, 1397.0, 1510.0, 1827.0, 1716.0, 1683.0, 1305.0, 1334.0, 1636.0, 1383.0, 1065.0, 1115.0, 1138.0, 868.0, 1082.0, 633.0, 571.0, 457.0, 376.0, 367.0, 388.0, 458.0, 553.0, 642.0, 1253.0, 1701.0, 2193.0, 2265.0, 2153.0, 1598.0, 1207.0, 734.0, 531.0, 511.0, 833.0, 762.0, 1154.0, 1166.0, 1298.0, 900.0, 783.0, 693.0, 521.0, 407.0, 357.0, 335.0, 542.0, 458.0, 560.0, 624.0, 758.0, 1065.0, 985.0, 1013.0, 1133.0, 1012.0, 1173.0, 1010.0, 1425.0, 1365.0, 1104.0, 992.0, 753.0, 791.0, 607.0, 762.0, 703.0, 803.0, 1436.0, 1384.0, 1537.0, 1355.0, 1071.0, 876.0, 1062.0, 972.0, 756.0, 714.0, 713.0, 816.0, 1063.0, 1501.0, 1485.0, 1616.0, 1710.0, 837.0, 592.0, 479.0, 294.0, 398.0, 674.0, 1308.0, 1763.0, 1877.0, 2035.0, 1308.0, 541.0, 643.0, 806.0, 981.0, 902.0, 993.0, 1025.0, 1041.0, 704.0, 489.0]
rt_list2 = np.array(rt_list)
i_list2 = np.array(i_list)

print 'original'
max_peaks, __ = peaks.peakdetect(i_list, rt_list, 6.0, 0.3)
print [x for (x, y) in max_peaks]


print 'savitzky golay'
i_list3 = sg.savitzky_golay(i_list2, 11, 3) # window size 51, polynomial order 3
i_list4 = i_list3.tolist()
max_peaks, __ = peaks.peakdetect(i_list4, rt_list, 6.0, 0.3)
print [x for (x, y) in max_peaks]

plt.plot(rt_list,i_list4)
plt.show()

#
#
# x = np.linspace(0,2*np.pi,100)
# y = np.sin(x) + np.random.random(100) * 0.2
# print type(y)
# yhat = sg.savitzky_golay(y, 51, 3)
# plt.plot(x,y)
# plt.plot(x,yhat, color='red')
# plt.show()