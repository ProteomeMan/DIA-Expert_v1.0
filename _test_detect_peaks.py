import peaks
import numpy as np
import matplotlib.pyplot as plt
import savitzky_golay as sg

rt_list = [2207.06, 2210.47, 2213.89, 2217.3, 2220.72, 2224.13, 2227.54, 2230.96, 2234.37, 2237.78, 2241.2, 2244.61, 2248.03, 2251.44, 2254.85, 2258.27, 2261.68, 2265.1, 2268.51, 2271.92, 2275.34, 2278.75, 2282.17, 2285.58, 2288.99, 2292.41, 2295.82, 2299.23, 2302.65, 2306.06, 2309.48, 2312.89, 2316.3, 2319.72, 2323.13, 2326.55, 2329.96, 2333.37, 2336.79, 2340.2, 2343.62, 2347.03, 2350.44, 2353.86, 2357.27, 2360.68, 2364.1, 2367.51, 2370.93, 2374.34, 2377.75, 2381.17, 2384.58, 2388.0, 2391.41, 2394.82, 2398.24, 2401.65, 2405.07, 2408.48, 2411.89, 2415.31, 2418.72, 2422.13, 2425.55, 2428.96, 2432.38, 2435.79, 2439.2, 2442.62, 2446.03, 2449.45, 2452.86, 2456.27, 2459.69, 2463.1, 2466.52, 2469.93, 2473.34, 2476.76, 2480.17, 2483.58, 2487.0, 2490.41, 2493.83, 2497.24, 2500.65, 2504.07, 2507.48, 2510.9, 2514.31, 2517.72, 2521.14, 2524.55, 2527.97, 2531.38, 2534.79, 2538.21, 2541.62, 2545.03, 2548.45, 2551.86, 2555.28, 2558.69, 2562.1, 2565.52, 2568.93, 2572.35, 2575.76, 2579.17, 2582.59, 2586.0, 2589.42, 2592.83, 2596.24, 2599.66, 2603.07, 2606.48, 2609.9, 2613.31, 2616.73, 2620.14, 2623.55, 2626.97, 2630.38, 2633.8, 2637.21, 2640.62, 2644.04, 2647.45, 2650.87, 2654.28, 2657.69, 2661.11, 2664.52, 2667.93, 2671.35, 2674.76, 2678.18, 2681.59, 2685.0, 2688.42, 2691.83, 2695.25, 2698.66, 2702.07, 2705.49, 2708.9, 2712.32, 2715.73, 2719.14, 2722.56, 2725.97, 2729.38, 2732.8, 2736.21, 2739.63, 2743.04, 2746.45, 2749.87, 2753.28, 2756.7, 2760.11, 2763.52, 2766.94, 2770.35, 2773.77, 2777.18, 2780.59, 2784.01, 2787.42, 2790.83, 2794.25, 2797.66, 2801.08, 2804.49]

i_list = [20.0, 30.0, 40.0, 70.0, 40.0, 50.0, 91.0, 30.0, 30.0, 20.0, 70.0, 70.0, 50.0, 40.0, 60.0, 60.0, 90.0, 80.0, 71.0, 100.0, 61.0, 91.0, 91.0, 70.0, 10.0, 40.0, 10.0, 40.0, 0.0, 40.0, 60.0, 20.0, 40.0, 30.0, 30.0, 0.0, 40.0, 20.0, 10.0, 50.0, 80.0, 30.0, 70.0, 30.0, 50.0, 20.0, 30.0, 20.0, 30.0, 30.0, 30.0, 0.0, 60.0, 20.0, 40.0, 50.0, 30.0, 40.0, 40.0, 20.0, 10.0, 60.0, 20.0, 60.0, 91.0, 100.0, 111.0, 30.0, 50.0, 40.0, 40.0, 80.0, 60.0, 110.0, 152.0, 90.0, 131.0, 70.0, 50.0, 20.0, 40.0, 50.0, 30.0, 10.0, 30.0, 50.0, 20.0, 30.0, 10.0, 30.0, 10.0, 20.0, 40.0, 30.0, 30.0, 50.0, 40.0, 60.0, 20.0, 50.0, 161.0, 110.0, 236.0, 234.0, 306.0, 142.0, 255.0, 245.0, 376.0, 552.0, 852.0, 944.0, 1103.0, 941.0, 679.0, 602.0, 448.0, 531.0, 408.0, 296.0, 264.0, 316.0, 203.0, 140.0, 100.0, 162.0, 80.0, 131.0, 121.0, 70.0, 163.0, 152.0, 122.0, 111.0, 91.0, 50.0, 101.0, 60.0, 71.0, 61.0, 91.0, 112.0, 90.0, 224.0, 305.0, 233.0, 297.0, 214.0, 70.0, 152.0, 110.0, 152.0, 60.0, 131.0, 173.0, 140.0, 90.0, 100.0, 60.0, 121.0, 71.0, 50.0, 121.0, 80.0, 50.0, 61.0, 80.0, 61.0, 90.0, 81.0, 70.0, 40.0, 60.0, 70.0, 121.0, 90.0]

#
# print 'original'
max_peaks, __ = peaks.peakdetect(i_list, rt_list, 3.0, 0.3)
print [x for (x, y) in max_peaks]


# print 'savitzky golay'
# i_list3 = sg.savitzky_golay(i_list2, 11, 3) # window size 51, polynomial order 3
# i_list4 = i_list3.tolist()
# max_peaks, __ = peaks.peakdetect(i_list4, rt_list, 6.0, 0.3)
# print [x for (x, y) in max_peaks]

# plt.plot(rt_list,i_list2)
# plt.show()

#
#
# x = np.linspace(0,2*np.pi,100)
# y = np.sin(x) + np.random.random(100) * 0.2
# print type(y)
# yhat = sg.savitzky_golay(y, 51, 3)
# plt.plot(x,y)
# plt.plot(x,yhat, color='red')
# plt.show()