import peaks
import numpy as np
import matplotlib.pyplot as plt
import savitzky_golay as sg

rt_list = [3379.15, 3382.58, 3386.0, 3389.43, 3392.86, 3396.28, 3399.71, 3403.13, 3406.56, 3409.99, 3413.41, 3416.84, 3420.27, 3423.69, 3427.12, 3430.55, 3433.97, 3437.4, 3440.82, 3444.25, 3447.68, 3451.1, 3454.53, 3457.96, 3461.38, 3464.81, 3468.24, 3471.66, 3475.09, 3478.51, 3481.94, 3485.37, 3488.79, 3492.22, 3495.65, 3499.07, 3502.5, 3505.93, 3509.35, 3512.78, 3516.21, 3519.63, 3523.06, 3526.48, 3529.91, 3533.34, 3536.76, 3540.19, 3543.62, 3547.04, 3550.47, 3553.9, 3557.32, 3560.75, 3564.17, 3567.6, 3571.03, 3574.45, 3577.88, 3581.31, 3584.73, 3588.16, 3591.59, 3595.01, 3598.44, 3601.86, 3605.29, 3608.72, 3612.14, 3615.57, 3619.0, 3622.42, 3625.85, 3629.28, 3632.7, 3636.13, 3639.55, 3642.98, 3646.41, 3649.83, 3653.26, 3656.69, 3660.11, 3663.54, 3666.97, 3670.39, 3673.82, 3677.24, 3680.67, 3684.1, 3687.52, 3690.95, 3694.38, 3697.8, 3701.23, 3704.66, 3708.08, 3711.51, 3714.94, 3718.36, 3721.79, 3725.21, 3728.64, 3732.07, 3735.49, 3738.92, 3742.35, 3745.77, 3749.2, 3752.63, 3756.05, 3759.48, 3762.9, 3766.33, 3769.76, 3773.18, 3776.61, 3780.04, 3783.46, 3786.89, 3790.32, 3793.74, 3797.17, 3800.59, 3804.02, 3807.45, 3810.87, 3814.3, 3817.73, 3821.15, 3824.58, 3828.01, 3831.43, 3834.86, 3838.28, 3841.71, 3845.14, 3848.56, 3851.99, 3855.42, 3858.84, 3862.27, 3865.7, 3869.12, 3872.55, 3875.97, 3879.4, 3882.83, 3886.25, 3889.68, 3893.11, 3896.53, 3899.96, 3903.39, 3906.81, 3910.24, 3913.67, 3917.09, 3920.52, 3923.94, 3927.37, 3930.8, 3934.22, 3937.65, 3941.08, 3944.5, 3947.93, 3951.36, 3954.78, 3958.21, 3961.63, 3965.06, 3968.49, 3971.91, 3975.34]
i_list = [0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 10.0, 20.0, 30.0, 40.0, 40.0, 10.0, 40.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 50.0, 30.0, 10.0, 275.0, 635.0, 2276.0, 3285.0, 4109.0, 3122.0, 1102.0, 344.0, 60.0, 20.0, 10.0, 10.0, 20.0, 10.0, 30.0, 10.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 100.0, 101.0, 10.0, 30.0, 30.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 327.0, 1479.0, 5076.0, 14310.0, 25394.0, 27223.0, 18507.0, 10921.0, 8724.0, 16348.0, 25820.0, 25904.0, 15658.0, 7116.0, 2175.0, 489.0, 222.0, 110.0, 60.0, 91.0, 70.0, 10.0, 111.0, 90.0, 51.0, 40.0, 40.0, 30.0, 40.0, 50.0, 20.0, 20.0, 40.0, 40.0, 80.0, 30.0, 10.0, 40.0, 50.0, 20.0, 80.0, 101.0, 90.0, 20.0, 0.0, 30.0, 10.0, 10.0, 90.0, 201.0, 304.0, 365.0, 397.0, 264.0, 172.0, 90.0, 50.0, 40.0, 40.0, 30.0, 40.0, 40.0, 40.0, 162.0, 121.0, 120.0, 70.0, 50.0, 70.0, 160.0, 173.0, 212.0, 213.0, 202.0, 336.0, 713.0, 1168.0, 1927.0, 2221.0, 1613.0, 917.0, 368.0, 243.0, 60.0, 40.0, 40.0, 40.0, 30.0, 30.0, 30.0, 30.0, 50.0]
# i_list2 = sg.savitzky_golay(np.array(i_list), 9, 3).tolist()

i_list2 = [0.0, -0.08658008658008765, 3.766233766233766, 5.41125541125541, 6.839826839826838, 9.13419913419913, 12.337662337662334, 16.926406926406923, 14.891774891774888, 11.991341991341988, 13.982683982683978, 13.766233766233762, 11.341991341991339, 11.991341991341987, 13.896103896103893, 18.441558441558435, 17.96536796536796, 17.748917748917744, 17.922077922077918, 17.142857142857135, 17.878787878787872, 24.41558441558441, 24.978354978354975, 32.857142857142854, 34.632034632034625, 29.69696969696969, 20.43290043290043, 11.168831168831163, 8.051948051948047, 9.523809523809522, 5.887445887445885, 4.329004329004327, 9.220779220779217, 15.670995670995666, -5.649350649350662, -20.80086580086583, -101.21645021645031, 28.805194805194674, 438.9177489177486, 1277.307359307359, 2324.7445887445883, 3017.1948051948048, 3146.4155844155844, 2710.268398268398, 1788.0389610389607, 840.0562770562768, 102.61038961038945, -135.4891774891776, -58.3809523809524, -12.095238095238106, 11.082251082251078, 13.98268398268398, 21.212121212121207, 22.987012987012985, 19.740259740259734, 18.09523809523809, 11.38528138528138, 9.090909090909086, 5.454545454545453, 1.8181818181818155, 6.277056277056276, 6.883116883116882, 5.930735930735928, 9.177489177489173, 9.999999999999996, 10.822510822510818, 5.88744588744588, 11.207792207792197, 34.73593073593073, 47.74458874458875, 55.08225108225108, 60.55844155844156, 55.12554112554112, 39.692640692640694, 15.298701298701294, 11.900432900432895, 17.359307359307355, 11.471861471861468, 8.831168831168828, -13.190476190476204, -95.89177489177494, -298.9047619047621, -653.277056277057, -141.69264069264182, 3128.0346320346302, 9297.939393939392, 15768.584415584412, 20105.16883116883, 20691.138528138523, 18453.190476190473, 15959.238095238092, 15574.37662337662, 17416.770562770558, 19801.220779220777, 19897.056277056276, 16651.770562770558, 10524.34199134199, 4238.229437229436, 494.6320346320336, -418.96536796536833, -319.818181818182, -65.96536796536806, 41.43722943722941, 57.66233766233764, 68.5151515151515, 71.00432900432898, 64.96536796536795, 61.333333333333314, 55.44588744588743, 38.5194805194805, 35.86147186147185, 34.411255411255404, 32.813852813852805, 28.3116883116883, 36.14718614718613, 41.42857142857142, 40.34632034632033, 42.5108225108225, 44.025974025974016, 33.59307359307358, 29.562770562770552, 34.47619047619046, 60.818181818181806, 75.08225108225108, 68.95670995670994, 62.35497835497835, 50.99134199134198, 19.844155844155836, -1.4805194805194937, 4.675324675324653, 48.354978354978336, 113.17316017316017, 204.69264069264068, 292.2380952380952, 342.38961038961037, 333.70995670995666, 276.80519480519473, 195.42424242424244, 116.78354978354976, 57.043290043290014, 36.72727272727271, 30.38095238095237, 22.415584415584398, 36.78354978354977, 56.545454545454525, 83.7099567099567, 105.4199134199134, 110.85281385281384, 99.57575757575755, 90.01731601731599, 76.58874458874456, 97.75324675324671, 129.78354978354974, 157.29004329004326, 160.74025974025966, 177.4805194805194, 227.64502164502153, 444.87012987012963, 874.7402597402595, 1354.437229437229, 1701.233766233766, 1759.6926406926405, 1548.246753246753, 1123.9090909090905, 605.8268398268397, 218.32467532467524, 58.99999999999994, 19.402597402597372, 24.47619047619046, 19.034632034632025, 30.086580086580078, 28.961038961038952, 31.861471861471856, 39.30735930735929, 49.999999999999986]

#
# print 'original'
max_peaks, __ = peaks.peakdetect(i_list, rt_list, 3.0, 0.3)
print [x for (x, y) in max_peaks]


# print 'savitzky golay'
# i_list3 = sg.savitzky_golay(i_list2, 11, 3) # window size 51, polynomial order 3
# i_list4 = i_list3.tolist()
# max_peaks, __ = peaks.peakdetect(i_list4, rt_list, 6.0, 0.3)
# print [x for (x, y) in max_peaks]

# plt.plot(rt_list,i_list2)
# plt.show()

#
#
# x = np.linspace(0,2*np.pi,100)
# y = np.sin(x) + np.random.random(100) * 0.2
# print type(y)
# yhat = sg.savitzky_golay(y, 51, 3)
# plt.plot(x,y)
# plt.plot(x,yhat, color='red')
# plt.show()